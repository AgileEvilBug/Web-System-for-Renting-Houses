<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Rentify - Demo</title>
</head>
<body>
  <h1>Properties</h1>
  <div id="list"></div>

  <script>
    async function load() {
      const res = await fetch('/api/properties');
      const data = await res.json();
      const list = document.getElementById('list');
      list.innerHTML = data.map(p => `
        <div style="border:1px solid #ccc;padding:8px;margin:8px;">
          <h3>${p.title} - $${p.pricePerNight}/night</h3>
          <p>${p.description}</p>
          <p>${p.address}</p>
          <button onclick="book(${p.id})">Book 1 night</button>
        </div>
      `).join('');
    }
    async function book(id) {
      const start = new Date().toISOString().split('T')[0];
      const end = new Date(Date.now() + 24*60*60*1000).toISOString().split('T')[0];
      const res = await fetch('/api/bookings', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ propertyId: id, startDate: start, endDate:end })
      });
      if (res.ok) alert('Booked!');
      else alert('Failed to book: ' + await res.text());
    }
    load();
  </script>
</body>
</html>
